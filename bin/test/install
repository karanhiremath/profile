#!/bin/bash
# Install Docker testing infrastructure
# This script ensures Docker is available for testing

set -euo pipefail

shopt -s failglob

. "${PROFILE_DIR}"/bin/sh/shell_fns --source-only

app_name="docker"

MACHINE="$(uname -s)"
ARCH="$(uname -m)"

install_messages "start" "$app_name"

if command -v docker > /dev/null 2>&1; then
    echo "Docker already installed!"
    docker --version
else
    echo "Docker not found. Please install Docker manually."
    echo ""
    echo "Installation instructions:"
    echo "  Ubuntu/Debian: https://docs.docker.com/engine/install/ubuntu/"
    echo "  Mac: https://docs.docker.com/desktop/install/mac-install/"
    echo "  RHEL: https://docs.docker.com/engine/install/rhel/"
    echo ""
    exit 1
fi

# Verify Docker is running
if ! docker ps > /dev/null 2>&1; then
    echo "Docker is installed but not running or accessible."
    echo "Please start Docker or check permissions."
    exit 1
fi

echo "Docker is ready for testing!"

install_messages "end" "$app_name"
