#!/bin/bash

set -euo pipefail

shopt -s failglob

. "${PROFILE_DIR}"/bin/sh/shell_fns --source-only

app_name="gh"

echo "Updating GitHub CLI..."

MACHINE="$(uname -s)"

case "${MACHINE}" in
    Darwin|Mac)
        if command -v brew >/dev/null 2>&1; then
            echo "Updating gh via Homebrew..."
            brew upgrade gh
        else
            echo "Homebrew not available. Cannot update gh."
            exit 1
        fi
        ;;
    Linux)
        if command -v apt-get >/dev/null 2>&1; then
            echo "Updating gh via apt..."
            sudo apt-get update && sudo apt-get upgrade -y gh
        elif command -v dnf >/dev/null 2>&1; then
            echo "Updating gh via dnf..."
            sudo dnf upgrade -y gh
        elif command -v yum >/dev/null 2>&1; then
            echo "Updating gh via yum..."
            sudo yum upgrade -y gh
        else
            echo "Package manager not supported. Cannot update gh."
            exit 1
        fi
        ;;
    *)
        echo "Unsupported platform: ${MACHINE}"
        exit 1
        ;;
esac

echo "gh update complete."
