#!/bin/bash

set -euo pipefail

shopt -s failglob

. "${PROFILE_DIR}"/bin/sh/shell_fns --source-only

app_name="steampipe"

MACHINE="$(uname -s)"
ARCH="$(uname -m)"

install_messages "start" "$app_name"

case "${MACHINE}" in
    Darwin|Mac)
        echo "Installing Steampipe on Mac..."
        brew install turbot/tap/steampipe
        ;;
    Linux)
        echo "Installing Steampipe on Linux..."
        # Use official install script
        sudo /bin/sh -c "$(curl -fsSL https://raw.githubusercontent.com/turbot/steampipe/main/install.sh)"
        ;;
    *)
        echo "Unsupported platform: ${MACHINE}"
        echo "Please visit https://steampipe.io/downloads for manual installation instructions"
        exit 1
        ;;
esac

install_messages "end" "$app_name"
