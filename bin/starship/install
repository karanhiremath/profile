#!/bin/bash

set -euo pipefail

shopt -s failglob

. "${APP_BIN}/sh/shell_fns" --source-only

app_name="starship"

MACHINE="$(uname -s)"
ARCH="$(uname -m)"

if command -v starship >/dev/null 2>&1; then
    echo "Starship already installed!"
else
    install_messages "start" "$app_name"

    case "${MACHINE}" in
        Darwin|Mac)
            echo "Installing starship on Mac..."
            brew install starship
            ;;
        Linux)
            echo "Installing starship on Linux..."
            # Use official installer script
            curl -sS https://starship.rs/install.sh | sh -s -- -y
            ;;
        *)
            echo "Using generic installer..."
            curl -sS https://starship.rs/install.sh | sh -s -- -y
            ;;
    esac

    install_messages "end" "$app_name"
fi
